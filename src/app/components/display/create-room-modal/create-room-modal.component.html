<p-dialog
  header="Criar sala"
  [modal]="true"
  [visible]="visible() || false"
  (visibleChange)="handleSetVisible($event)"
  [closable]="!isLoading()"
  [breakpoints]="{ '960px': '50vw', '640px': '75vw', '480px': '95vw' }"
  [style]="{ width: '25rem' }"
  [dt]="dialogThemes.custom"
  styleClass="[&_.p-dialog-close-button]:rounded-lg! [&_.p-dialog-close-button]:hover:bg-stone-600/60! [&_.p-dialog-close-button]:text-stone-400! [&_.p-dialog-close-button]:size-7! [&_.p-dialog-close-button]:p-1.5!"
>
  <span class="p-text-secondary block mb-4"
    >Crie uma sala e convide seus amigos para participar.</span
  >

  <form [formGroup]="form" (ngSubmit)="createRoom()" class="space-y-4">
    <div class="flex flex-col space-y-1">
      <label for="name" class="text-sm" aria-required="true"
        >Nome <span class="text-red-600">*</span></label
      >
      <input
        pInputText
        type="text"
        id="name"
        formControlName="name"
        aria-errormessage="name-error"
        [dt]="inputThemes.outlined"
        fluid
      />
      @if (form.get('name')?.invalid && form.get('name')?.touched) {
      <small id="name-error" class="text-red-600">Nome inválido.</small>
      }
    </div>

    <div class="flex flex-col space-y-1">
      <label for="picture" class="text-sm">URL da imagem</label>
      <input
        pInputText
        type="text"
        id="picture"
        formControlName="picture"
        aria-errormessage="picture-error"
        placeholder="https://example.com/image.png"
        [dt]="inputThemes.outlined"
        fluid
      />
      @if (form.get('picture')?.invalid && form.get('picture')?.touched) {
      <small id="picture-error" class="text-red-600">URL inválida.</small>
      }
    </div>

    <div class="flex flex-col space-y-1">
      <label for="description" class="text-sm" aria-required="true">Descrição</label>
      <textarea
        pTextarea
        id="description"
        formControlName="description"
        aria-errormessage="description-error"
        rows="2"
        [maxlength]="200"
        [dt]="inputThemes.outlined"
        [autoResize]="true"
        fluid
      ></textarea>
      @if (form.get('description')?.invalid && form.get('description')?.touched) {
      <small id="description-error" class="text-red-600">Descrição inválida.</small>
      }
    </div>

    <div class="w-full flex">
      <p-button class="ml-auto" label="Avançado" icon="pi pi-chevron-down" pStyleClass=".advanced-block" toggleClass="hidden" styleClass="bg-transparent p-0! text-stone-500! text-sm! [&_.p-button-icon]:text-sm! [&_.p-button-icon]:text-stone-500!" />
    </div>

    <div class="advanced-block hidden">
      <div class="flex flex-col space-y-1">
        <label for="maxMembers" class="text-sm" aria-required="true"
          >Máximo de membros</label
        >
        <p-inputnumber
          id="maxMembers"
          formControlName="maxMembers"
          aria-errormessage="maxMembers-error"
          fluid
          styleClass="[&_.p-inputnumber-input]:bg-[#26262677]! [&_.p-inputnumber-input]:text-stone-100! [&_.p-inputnumber-input]:border-stone-600! [&_.p-inputnumber-input:hover]:border-stone-500! [&_.p-inputnumber-input:focus]:ring-stone-500! [&_.p-inputnumber-input:focus]:border-stone-600! [&_.p-inputnumber-button]:border-stone-600! rounded-[8px]!"
          [min]="1"
          [max]="200"
          [showButtons]="true"
          buttonLayout="horizontal"
          inputId="horizontal"
          spinnerMode="horizontal"
          [step]="2"
        >
          <ng-template #incrementbuttonicon>
            <span class="pi pi-plus"></span>
          </ng-template>
          <ng-template #decrementbuttonicon>
            <span class="pi pi-minus"></span>
          </ng-template>
        </p-inputnumber>
        @if (form.get('maxMembers')?.invalid && form.get('maxMembers')?.touched) {
        <small id="maxMembers-error" class="text-red-600"
          >Número de membros inválido.</small
        >
        }
      </div>
    </div>

    <div class="flex justify-end gap-2 mt-4">
      <p-button
        label="Cancelar"
        severity="secondary"
        (click)="handleSetVisible(false)"
        [disabled]="isLoading()"
      />
      <p-button
        label="Criar"
        type="submit"
        [loading]="isLoading()"
        fluid
      ></p-button>
    </div>
  </form>
</p-dialog>
